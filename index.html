
<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Ä–æ—Å—Ç–∞ —Ü–µ–Ω—ã —Ç–æ–∫–µ–Ω–æ–≤ Binance Alpha</title>
  <style>
    body { font-family: sans-serif; padding: 20px; background: #f6f6f6; }
    table { border-collapse: collapse; width: 100%; background: white; margin-top: 20px; }
    th, td { border: 1px solid #ccc; padding: 10px; text-align: center; }
    th { background: #f0f0f0; }
    button { padding: 10px 20px; font-weight: bold; cursor: pointer; margin-top: 20px; }
    .up { color: green; font-weight: bold; }
    .same { color: gray; }
    .error { color: red; }
  </style>
</head>
<body>
  <h1>–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Ä–æ—Å—Ç–∞ —Ü–µ–Ω—ã —Ç–æ–∫–µ–Ω–æ–≤ Binance Alpha</h1>

  <button id="toggleButton">‚ñ∂ –ù–∞—á–∞—Ç—å –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ</button>

  <table>
    <thead>
      <tr>
        <th>–¢–æ–∫–µ–Ω</th>
        <th>–¢–µ–∫—É—â–∞—è —Ü–µ–Ω–∞ (USDT)</th>
        <th>–ü—Ä–µ–¥—ã–¥—É—â–∞—è —Ü–µ–Ω–∞</th>
        <th>–ò–∑–º–µ–Ω–µ–Ω–∏–µ</th>
        <th>–°—Ç–∞—Ç—É—Å</th>
      </tr>
    </thead>
    <tbody id="priceTable"></tbody>
  </table>

  <audio id="alertSound" src="https://actions.google.com/sounds/v1/alarms/digital_watch_alarm_long.ogg" preload="auto"></audio>

  <script>
    const tokens = ['AB', 'OL', 'LA', 'RDO', 'RWA', 'BDXN', 'ELDE', 'TGT', 'VELO', 'ROAM', 'PUNDIAI'];
    const proxy = 'https://cors-anywhere.herokuapp.com/';
const baseUrl = proxy + 'https://www.binance.com/bapi/asset/v1/public/alpha/project/detail?projectCode=';
    const checkInterval = 5 * 60 * 1000;
    const thresholdPercent = 1;
    const tokenState = {};
    let intervalId = null;

    const table = document.getElementById('priceTable');
    const button = document.getElementById('toggleButton');
    const alertSound = document.getElementById('alertSound');

    function createOrUpdateRow(token, current, previous, changeText, status, statusClass) {
      let row = document.getElementById('row-' + token);
      if (!row) {
        row = document.createElement('tr');
        row.id = 'row-' + token;
        row.innerHTML = `<td>${token}</td><td></td><td></td><td></td><td></td>`;
        table.appendChild(row);
      }
      const cells = row.getElementsByTagName('td');
      cells[1].textContent = current ?? '-';
      cells[2].textContent = previous ?? '-';
      cells[3].textContent = changeText ?? '-';
      cells[4].textContent = status ?? '-';
      cells[4].className = statusClass;
    }

    async function fetchPrice(token) {
      try {
        const res = await fetch(baseUrl + token);
        const data = await res.json();
        const price = parseFloat(data?.data?.price?.priceInUsd);
        if (isNaN(price)) throw new Error('–¶–µ–Ω–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');
        return price;
      } catch (e) {
        console.error(`–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è ${token}:`, e);
        createOrUpdateRow(token, '-', '-', '-', '–æ—à–∏–±–∫–∞', 'error');
        return null;
      }
    }

    async function checkPrices() {
      for (const token of tokens) {
        const current = await fetchPrice(token);
        if (current === null) continue;

        const previous = tokenState[token];
        let change = '-';
        let status = '-';
        let cls = 'same';

        if (previous !== undefined) {
          const diff = ((current - previous) / previous) * 100;
          change = diff.toFixed(2) + '%';
          if (diff >= thresholdPercent) {
            status = 'üîî —Ä–æ—Å—Ç';
            cls = 'up';
            tokenState[token] = current;
            alertSound.play();
          } else {
            status = '‚Äî';
            cls = 'same';
          }
        } else {
          tokenState[token] = current;
        }

        createOrUpdateRow(token, current.toFixed(6), previous?.toFixed(6), change, status, cls);
      }
    }

    button.addEventListener('click', () => {
      if (intervalId) {
        clearInterval(intervalId);
        intervalId = null;
        button.textContent = '‚ñ∂ –ù–∞—á–∞—Ç—å –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ';
      } else {
        checkPrices();
        intervalId = setInterval(checkPrices, checkInterval);
        button.textContent = '‚è∏ –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ';
      }
    });
  </script>
</body>
</html>
